FROM judge0/judge0:1.13.0

EXPOSE $PORT

ENV RAILS_ENV=production
ENV DATABASE_URL=sqlite3:///tmp/db.sqlite3
ENV REDIS_URL=redis://localhost:6379
ENV ENABLE_WAIT_RESULT=true
ENV ENABLE_COMPILER_OPTIONS=true
ENV ENABLE_COMMAND_LINE_ARGUMENTS=true
ENV ENABLE_SUBMISSION_DELETE=true
ENV ENABLE_CALLBACKS=false
ENV CALLBACKS_MAX_TRIES=1
ENV CALLBACKS_TIMEOUT=5
ENV MAX_QUEUE_SIZE=100
ENV MAX_JOBS_IN_QUEUE=30
ENV SUBMISSION_CACHE_DURATION=86400
ENV USE_DOCS_AS_HOMEPAGE=true
ENV ALLOW_ENABLE_NETWORK=true
ENV ENABLE_NETWORK=false
ENV ENABLE_PER_PROCESS_AND_THREAD_TIME_LIMIT=false
ENV ENABLE_PER_PROCESS_AND_THREAD_MEMORY_LIMIT=false
ENV MAX_CPU_TIME_LIMIT=15
ENV MAX_CPU_EXTRA_TIME=5
ENV MAX_WALL_TIME_LIMIT=20
ENV MAX_MEMORY_LIMIT=512000
ENV MAX_STACK_LIMIT=64000
ENV MAX_PROCESSES_AND_OR_THREADS=60
ENV MAX_NUMBER_OF_RUNS=20
ENV MAX_REDIRECT_STDERR_TO_STDOUT=false
ENV MAX_STDOUT_SIZE=1024
ENV MAX_STDERR_SIZE=1024
ENV MAX_COMPILE_OUTPUT_SIZE=1024
ENV MAX_MESSAGE_SIZE=1024
ENV MAX_OTHER_FILES_SIZE_LIMIT=4096
ENV MAX_SOURCE_CODE_SIZE_LIMIT=16384
ENV NUMBER_OF_RUNS_LIMIT=20
ENV CPU_TIME_LIMIT=2
ENV CPU_EXTRA_TIME=0.5
ENV WALL_TIME_LIMIT=10
ENV MEMORY_LIMIT=128000
ENV STACK_LIMIT=64000
ENV MAX_PROCESSES_AND_OR_THREADS_LIMIT=15
ENV ENABLE_BATCHED_SUBMISSIONS=false
ENV CALLBACK_URL=
ENV CPU_SET=
ENV MAX_EXTRACT_SIZE=10240
ENV FORCE_COMPILATION_ON_ANY_LANGUAGE=false
ENV USE_ADVANCED_ISOLATE_OPTIONS=false
ENV ADVANCED_ISOLATE_OPTIONS=
ENV USE_RAW_ISOLATE_OPTIONS=false
ENV RAW_ISOLATE_OPTIONS=

CMD ["./scripts/server"]